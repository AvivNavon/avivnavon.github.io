<!-- Dark mode toggle + logic -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const root = document.documentElement;
  const KEY = 'theme';
  const mq = window.matchMedia('(prefers-color-scheme: dark)');

  // 1. Ensure a theme is set
  const saved = localStorage.getItem(KEY);
  if (saved === 'dark' || saved === 'light') {
    root.setAttribute('data-theme', saved);
  } else {
    root.setAttribute('data-theme', mq.matches ? 'dark' : 'light');
  }

  // 2. Create the toggle button if it doesn't exist
  let btn = document.getElementById('theme-toggle');
  if (!btn) {
    btn = document.createElement('button');
    btn.id = 'theme-toggle';
    btn.className = 'theme-toggle';
    btn.setAttribute('aria-label', 'Toggle dark mode');
    btn.textContent = 'üåì';
    btn.style.cssText = `
      position: fixed;
      top: 12px;
      right: 14px;
      z-index: 9999;
      background: transparent;
      border: 0;
      padding: 6px 8px;
      font-size: 18px;
      line-height: 1;
      cursor: pointer;
      border-radius: 8px;
      color: inherit;
    `;
    document.body.appendChild(btn);
  }

  // 3. Toggle theme when clicked
  btn.addEventListener('click', function() {
    const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
    root.setAttribute('data-theme', next);
    localStorage.setItem(KEY, next);
  });

  // 4. Follow OS preference if user hasn‚Äôt saved choice
  mq.addEventListener('change', e => {
    if (!localStorage.getItem(KEY)) {
      root.setAttribute('data-theme', e.matches ? 'dark' : 'light');
    }
  });
});
</script>

<script>
  // Add a short overlay fade when switching themes
  const root = document.documentElement;
  const fadeMs = 250;
  const addFade = () => {
    root.classList.add("is-transitioning");
    setTimeout(() => root.classList.remove("is-transitioning"), fadeMs);
  };

  const btn = document.getElementById("theme-toggle");
  if (btn) {
    const oldHandler = btn.onclick || null;
    btn.onclick = e => {
      if (typeof oldHandler === "function") oldHandler(e);
      addFade();
    };
  }
</script>

<!-- <script>
(function () {
  const btn = document.getElementById('theme-toggle');
  if (!btn) return;

  function placeToggle() {
    const isMobile = window.matchMedia('(max-width: 768px)').matches;
    const titleLink = document.querySelector('.masthead .site-title a, .masthead .site-title');

    if (isMobile && titleLink && btn.parentElement !== titleLink.parentElement) {
      // Insert the button right after the title link
      titleLink.insertAdjacentElement('afterend', btn);
      btn.classList.add('in-header');
    } else if (!isMobile && btn.classList.contains('in-header')) {
      // Put it back to floating position on desktop
      document.body.appendChild(btn);
      btn.classList.remove('in-header');
    }
  }

  placeToggle();
  window.addEventListener('resize', placeToggle);
})();
</script> -->

<script>
(function () {
  const btn = document.getElementById('theme-toggle');
  if (!btn) return;

  // the floating style we want on desktop
  const floatingStyle = `
    position: fixed;
    top: 12px;
    left: 14px;
    z-index: 10000;
    width: 32px; height: 32px;
    line-height: 1; font-size: 18px;
    cursor: pointer; border-radius: 9999px;
    color: inherit; background: transparent;
  `;

  function placeToggle() {
    const isMobile = window.matchMedia('(max-width: 768px)').matches;
    const titleLink =
      document.querySelector('.masthead .site-title a') ||
      document.querySelector('.masthead .site-title');

    if (isMobile && titleLink) {
      // put it right AFTER your name
      titleLink.insertAdjacentElement('afterend', btn);
      btn.classList.add('in-header');
      btn.removeAttribute('style');          // ‚Üê kill fixed inline style
    } else {
      // float it on desktop in top-left
      document.body.appendChild(btn);
      btn.classList.remove('in-header');
      btn.setAttribute('style', floatingStyle); // ‚Üê restore fixed inline style
    }
  }

  placeToggle();
  window.addEventListener('resize', placeToggle);
})();
</script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const btn = document.getElementById('theme-toggle');
  const header = document.querySelector('.masthead .masthead__inner-wrap');
  if (btn && header && btn.parentElement !== header) {
    header.appendChild(btn);        // put it inside the header
    btn.removeAttribute('style');   // kill any inline fixed styles
    btn.classList.add('in-header'); // use the CSS below
  }
});
</script>



